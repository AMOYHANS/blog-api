import{d as E,u as I,r as l,a as r,c,j as S,e as j,i as v,f as s,g,s as m,x as P,b as V,v as y,m as B,_ as L}from"./index-DusIQIs_.js";import{u as $,E as N}from"./post-CwxrulT0.js";import{I as T,u as D}from"./index-CcQzDVjc.js";import{c as b}from"./index-DH2sJWvk.js";import"./request-Lpnrrob0.js";const F={key:0,class:"imgBox"},O=["src"],A={class:"fileAndEmoji"},M={style:{display:"flex"}},W={class:"submit"},X=E({__name:"index",setup(q){const p=B(),{setWritePost:f}=$(),{userId:k}=I(),a=l(),w=window.URL||window.webkitURL,i=l(!1),u=l(""),n=l(""),C=l(),d=l(!1),h=t=>{a.value=t.target.files[0]},R=t=>{n.value+=t.innerText},U=t=>{t.target!==C.value&&(i.value=!1)},_=async()=>{if(a.value){const t=new FormData;t.append("file",a.value);const e=await D(t),o={title:u.value,content:n.value,pic:"http://yxhe51918689.vicp.fun/"+e.data,authorId:k},x=await b(o);f(x.data),alert("ä¸Šä¼ æˆåŠŸ"),p.push("/post/"+x.data.id)}else{const t={title:u.value,content:n.value,authorId:k},e=await b(t);f(e.data),alert("ä¸Šä¼ æˆåŠŸ"),p.push("/post/"+e.data.id)}};return(t,e)=>(r(),c("div",{class:"container",onClick:U},[a.value?(r(),c("div",F,[d.value?(r(),S(T,{key:0,src:j(w).createObjectURL(a.value),onImgClose:e[0]||(e[0]=o=>d.value=!1)},null,8,["src"])):v("",!0),s("img",{src:j(w).createObjectURL(a.value),alt:"",onClick:e[1]||(e[1]=o=>d.value=!0)},null,8,O),s("span",{onClick:e[2]||(e[2]=o=>a.value=void 0)},"X")])):v("",!0),s("div",A,[s("div",M,[s("label",{title:"å°é¢",onClick:e[3]||(e[3]=o=>a.value=void 0)},[g(" ðŸ“¸ "),a.value?v("",!0):(r(),c("input",{key:0,type:"file",onChange:h},null,32))]),s("label",{title:"emoji",ref_key:"emjRef",ref:C,onClick:e[4]||(e[4]=o=>i.value=!i.value)},[g("ðŸ˜‰ "),m(V(N,{onEmojiClick:R},null,512),[[P,i.value]])],512)]),s("div",W,[m(s("input",{type:"",placeholder:"èµ·ä¸ªæ ‡é¢˜å§...",autofocus:"","onUpdate:modelValue":e[5]||(e[5]=o=>u.value=o)},null,512),[[y,u.value]]),s("button",{onClick:_},"æäº¤")])]),m(s("textarea",{"onUpdate:modelValue":e[6]||(e[6]=o=>n.value=o),placeholder:"å†™ç‚¹ä»€ä¹ˆ...",id:"",cols:"30",rows:"10",onChange:e[7]||(e[7]=()=>{})},null,544),[[y,n.value]])]))}}),Q=L(X,[["__scopeId","data-v-159a38e6"]]);export{Q as default};
